<div class="dashboard-container flex-col-container">
  <div *ngIf="!pageLoading; else pageLoadingSpinner" class="flex-grow-1 d-flex flex-column">
    <div class="title mb-4">
      <button mat-icon-button (click)="navigateBack()">
        <img src="/content/images/back-arrow.svg" />
      </button>
      <span *ngIf="displayMode == 'CREATE'; else editContract" jhiTranslate="contractmanager.configuration.createContractType"
        >Create Contract Type</span
      >
      <ng-template #editContract>{{ contractTypeName.value }}</ng-template>
    </div>
    <div class="form-container">
      <form class="contrct-type-form" [formGroup]="contractTypeForm">
        <jhi-cm-stepper #cdkStepper [linear]="isLinear">
          <cdk-step [stepControl]="contractTypeForm">
            <ng-template cdkStepLabel>
              <div jhiTranslate="contractmanager.shared.details">Details</div>
            </ng-template>
            <div class="step-header">
              <span jhiTranslate="contractmanager.shared.details">Details</span>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
            </div>
            <div class="flex-col-container edit-container flex-grow-1" *ngIf="displayMode != 'VIEW'; else viewDetails">
              <div class="col-2-layout">
                <mat-form-field class="full-width" appearance="fill">
                  <mat-label jhiTranslate="contractmanager.configuration.contactTypeName">Contact Type Name</mat-label>
                  <input formControlName="contractTypeName" matInput required />
                  <mat-error *ngIf="contractTypeName.errors?.required" jhiTranslate="contractmanager.configuration.contactTypeNameRequired"
                    >Contract Type Name is required</mat-error
                  >
                  <mat-error
                    *ngIf="contractTypeName.errors?.minlength"
                    jhiTranslate="contractmanager.configuration.contactTypeNameMinLength"
                    >Contract Type Name must be at least 3 characters</mat-error
                  >
                  <mat-error
                    *ngIf="contractTypeName.errors?.maxlength"
                    jhiTranslate="contractmanager.configuration.contactTypeNameMaxLength"
                    >Contract Type Name must be less than 30 characters</mat-error
                  >
                </mat-form-field>

                <mat-form-field class="full-width" appearance="fill">
                  <mat-label jhiTranslate="contractmanager.configuration.contactTypeCode">Contact Type Code</mat-label>
                  <input formControlName="contractTypeCode" matInput readonly />
                  <mat-hint jhiTranslate="contractmanager.shared.autoGenerated">Auto Generated</mat-hint>
                </mat-form-field>
                <div>
                  <mat-form-field class="full-width" appearance="fill">
                    <mat-label jhiTranslate="contractmanager.configuration.contractCategory">Contract Category</mat-label>
                    <mat-select
                      formControlName="contractCategory"
                      (selectionChange)="onCategorySelect($event.value)"
                      required
                      [compareWith]="categoryCompare"
                    >
                      <mat-option *ngFor="let contractCategory of contractCategories | async" [value]="contractCategory.id">
                        {{ contractCategory.categoryName }}
                      </mat-option>
                    </mat-select>
                    <mat-error jhiTranslate="contractmanager.configuration.contractCategoryRequired"
                      >Contract Category is required</mat-error
                    >
                  </mat-form-field>
                  <div
                    class="full-width add-category"
                    (click)="openAddCategoryDialog()"
                    jhiTranslate="contractmanager.configuration.addNewCategory"
                  >
                    <!--                  <span class='material-icons-outlined>add_circle</span>-->
                    <mat-icon>add_circle</mat-icon>Add New Category
                  </div>
                </div>

                <mat-form-field class="width comment-container" appearance="fill">
                  <mat-label jhiTranslate="contractmanager.shared.description">Description</mat-label>
                  <textarea class="comment-box" matInput formControlName="description"></textarea>
                  <mat-error *ngIf="description.errors?.maxlength" jhiTranslate="contractmanager.shared.descriptionMaxLength"
                    >Description must be less than 1000 characters</mat-error
                  >
                </mat-form-field>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.allowThirdPartyPaper"
                    >Allow Third Party Paper <mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="allowThirdPartyPaper"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.allowClauseAssembly"
                    >Allow Clause Assembly <mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="allowClauseAssembly"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.QrCode">QR Code<mat-icon>help_outline</mat-icon> </span>
                  <div>
                    <mat-slide-toggle formControlName="qrCode"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.allowCopyWithAssociations"
                    >Allow Copy with Associations<mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="allowCopyWithAssociations"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.twoColumnAttributeLayout"
                    >Two column Attribute Layout<mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="twoColumnAttributeLayout"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.enableCollaboration"
                    >Enable Collaboration<mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="enableCollaboration"></mat-slide-toggle>
                  </div>
                </div>

                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.enableAutoSupersede"
                    >Enable Auto Supersede<mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="enableAutoSupersede"></mat-slide-toggle>
                  </div>
                </div>
                <div class="flex-row-container toggle-container">
                  <span jhiTranslate="contractmanager.configuration.expandOnMouseOver"
                    >Expand Drop-down on mouse over<mat-icon>help_outline</mat-icon>
                  </span>
                  <div>
                    <mat-slide-toggle formControlName="expandDropdownOnMouseHover"></mat-slide-toggle>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="displayMode == 'CREATE'; else buttons">
              <div class="d-flex justify-content-between mt-4">
                <div style="min-width: 100px"></div>
                <div>
                  <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                  <button mat-raised-button [disabled]="true" (click)="save()" jhiTranslate="contractmanager.shared.create">Create</button>
                </div>
                <button mat-button matStepperNext [disabled]="contractTypeForm.invalid" jhiTranslate="contractmanager.shared.next">
                  Next
                </button>
              </div>
            </div>
          </cdk-step>

          <cdk-step [stepControl]="contractTypeForm">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.shared.attributes">Attributes</span>
            </ng-template>
            <div class="flex-row-container step-header">
              <span jhiTranslate="contractmanager.shared.attributes">Attributes</span>
              <div class="flex-spacer"></div>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
              <div>
                <button
                  mat-button
                  color="primary"
                  (click)="openAttributeDialog('edit')"
                  *ngIf="selectedAttribute"
                  jhiTranslate="contractmanager.configuration.editAttribute"
                >
                  Edit Attribute
                </button>
                <button
                  mat-raised-button
                  color="primary"
                  (click)="openAttributeDialog('create')"
                  *ngIf="displayMode != 'VIEW'"
                  jhiTranslate="contractmanager.configuration.addAttribute"
                >
                  Add Attribute
                </button>
              </div>
            </div>
            <div class="flex-col-container edit-container flex-grow-1" *ngIf="displayMode != 'VIEW'; else viewAttributes">
              <div class="col-3-layout full-height">
                <div class="attr-search-wrapper">
                  <mat-form-field class="search-attribute">
                    <input
                      type="text"
                      placeholder="Search"
                      aria-label="Number"
                      matInput
                      [formControl]="globalAttributeSearchControl"
                      [(ngModel)]="globalAttributeSearch"
                    />
                    <button
                      mat-button
                      mat-icon-button
                      matSuffix
                      (click)="clearSearchField(globalAttributeSearchControl)"
                      *ngIf="globalAttributeSearch"
                    >
                      <mat-icon>close</mat-icon>
                    </button>
                  </mat-form-field>
                  <div class="scroll-y" style="height: 30vh">
                    <div
                      class="attr-search-list"
                      *ngFor="let attribute of attributeConfigs | attributeFilter: globalAttributeSearch"
                      (click)="selectAttribute(attribute, 'Attribute')"
                      [class.selected]="attribute === selectedAttribute"
                    >
                      {{ attribute.attributeName }}
                    </div>
                  </div>
                </div>
                <div class="attr-button-container">
                  <button class="attr-move-button" mat-icon-button (click)="addAttribute('Attribute')">
                    <mat-icon>keyboard_arrow_right</mat-icon>
                  </button>

                  <button class="attr-move-button" mat-icon-button (click)="removeAttribute('Attribute')">
                    <mat-icon>keyboard_arrow_left</mat-icon>
                  </button>
                </div>
                <div class="attr-search-wrapper">
                  <mat-form-field class="search-attribute">
                    <input
                      type="text"
                      placeholder="Search"
                      aria-label="Number"
                      matInput
                      [formControl]="selectedAttributeSearchControl"
                      [(ngModel)]="selectedAttributeSearch"
                    />
                    <button
                      mat-button
                      mat-icon-button
                      matSuffix
                      (click)="clearSearchField(selectedAttributeSearchControl)"
                      *ngIf="selectedAttributeSearch"
                    >
                      <mat-icon>close</mat-icon>
                    </button>
                  </mat-form-field>
                  <div class="scroll-y" style="height: 30vh">
                    <div
                      class="attr-search-list"
                      *ngFor="let attribute of selectedAttributes | attributeFilter: selectedAttributeSearch!"
                      (click)="selectAttribute(attribute, 'Attribute')"
                      [class.selected]="attribute === selectedAttribute"
                    >
                      {{ attribute.attributeName }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="displayMode == 'CREATE'; else buttons">
              <div class="d-flex justify-content-between mt-4">
                <button mat-button matStepperPrevious jhiTranslate="contractmanager.shared.previous">Previous</button>
                <div>
                  <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                  <button mat-raised-button color="primary" [disabled]="true" jhiTranslate="contractmanager.shared.create">Create</button>
                </div>
                <button mat-button matStepperNext (click)="prefillDpAttributes()" jhiTranslate="contractmanager.shared.next">Next</button>
              </div>
            </div>
          </cdk-step>

          <cdk-step [formGroup]="associationsForm" [stepControl]="associationsForm">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.configuration.associations">Associations</span>
            </ng-template>
            <div class="step-header">
              <span jhiTranslate="contractmanager.configuration.associations">Associations</span>
              <div class="flex-spacer"></div>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
              <div>
                <button
                  mat-raised-button
                  color="primary"
                  (click)="openAssociationDialog()"
                  *ngIf="displayMode != 'VIEW'"
                  jhiTranslate="contractmanager.configuration.addAssociations"
                >
                  Add Association
                </button>
              </div>
            </div>

            <div class="flex-col-container edit-container" *ngIf="displayMode != 'VIEW'; else viewAssociations">
              <div class="associations-container">
                <div
                  class="flex-row-container justify-space-intital association-container"
                  *ngFor="let row of contractTypesByCategory | async; let formIndex = index"
                >
                  <div>
                    {{ row.name }}
                  </div>
                  <button mat-button>
                    <mat-icon>add_circle</mat-icon>
                    <span jhiTranslate="contractmanager.shared.add">Add</span>
                  </button>
                </div>
              </div>
            </div>
            <div *ngIf="displayMode == 'CREATE'; else buttons">
              <div class="d-flex justify-content-between mt-4">
                <button mat-button matStepperPrevious jhiTranslate="contractmanager.shared.previous">Previous</button>
                <div>
                  <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                  <button mat-raised-button color="primary" [disabled]="true" jhiTranslate="contractmanager.shared.create">Create</button>
                </div>
                <button mat-button matStepperNext [disabled]="associationsForm.invalid" jhiTranslate="contractmanager.shared.next">
                  Next
                </button>
              </div>
            </div>
          </cdk-step>

          <cdk-step [stepControl]="contractTypeForm">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.configuration.displayPreference">Display Preference</span>
            </ng-template>
            <div class="flex-row-container step-header">
              <span jhiTranslate="contractmanager.configuration.displayPreference">Display Preference</span>
              <div class="flex-spacer"></div>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
            </div>
            <div class="display-pref-container" *ngIf="displayMode != 'VIEW'; else viewDisplayPreferences">
              <div class="display-pref-header">
                <span jhiTranslate="contractmanager.configuration.selectAttributeForTileView"
                  >Select any 4 attributes to show on agreement tile view
                </span>
              </div>
              <div class="col-3-layout search-container">
                <div>
                  <span jhiTranslate="contractmanager.configuration.availableAttributes">Available Attributes</span>
                  <div class="dp-attr-search-wrapper">
                    <mat-form-field class="search-attribute">
                      <input
                        type="text"
                        placeholder="Search"
                        aria-label="Number"
                        matInput
                        [formControl]="dpTileGlobalAttrSearchControl"
                        [(ngModel)]="dpTileGlobalAttrSearch"
                      />

                      <button
                        mat-button
                        mat-icon-button
                        matSuffix
                        (click)="clearSearchField(dpTileGlobalAttrSearchControl)"
                        *ngIf="dpTileGlobalAttrSearch"
                      >
                        <mat-icon>close</mat-icon>
                      </button>
                    </mat-form-field>
                    <div class="scroll-y dp-scroll-content">
                      <div
                        class="attr-search-list"
                        *ngFor="let attribute of dpTileAttributes | attributeFilter: dpTileGlobalAttrSearch!"
                        (click)="selectAttribute(attribute, 'dpTile')"
                        [class.selected]="attribute === selectedTileAttribute"
                      >
                        {{ attribute.attributeName }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="attr-button-container">
                  <button class="attr-move-button" mat-icon-button (click)="addAttribute('dpTile')">
                    <mat-icon>keyboard_arrow_right</mat-icon>
                  </button>

                  <button class="attr-move-button" mat-icon-button (click)="removeAttribute('dpTile')">
                    <mat-icon>keyboard_arrow_left</mat-icon>
                  </button>
                </div>
                <div>
                  <span jhiTranslate="contractmanager.configuration.selectedAttributes">Selected Attributes</span>
                  <div class="dp-attr-search-wrapper">
                    <mat-form-field class="search-attribute">
                      <input
                        type="text"
                        placeholder="Search"
                        aria-label="Number"
                        matInput
                        [formControl]="dpTileSelectedAttrSearchControl"
                        [(ngModel)]="dpTileSelectedAttrSearch"
                      />

                      <button
                        mat-button
                        mat-icon-button
                        matSuffix
                        (click)="clearSearchField(dpTileSelectedAttrSearchControl)"
                        *ngIf="dpTileSelectedAttrSearch"
                      >
                        <mat-icon>close</mat-icon>
                      </button>
                    </mat-form-field>
                    <div class="scroll-y dp-scroll-content">
                      <div
                        class="attr-search-list"
                        *ngFor="let attribute of selectedTileAttributes! | attributeFilter: dpTileSelectedAttrSearch!"
                        (click)="selectAttribute(attribute, 'dpTile')"
                        [class.selected]="attribute === selectedTileAttribute"
                      >
                        {{ attribute.attributeName }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="display-pref-header">
                <span jhiTranslate="contractmanager.configuration.selectAttributesForAgreementDetails"
                  >Select attributes to show on agreement details view
                </span>
              </div>
              <div class="col-3-layout">
                <div>
                  <span jhiTranslate="contractmanager.configuration.availableAttributes">Available Attributes</span>
                  <div class="dp-attr-search-wrapper">
                    <mat-form-field class="search-attribute">
                      <input
                        type="text"
                        placeholder="Search"
                        aria-label="Number"
                        matInput
                        [formControl]="dpListGlobalAttrSearchControl"
                        [(ngModel)]="dpListGlobalAttrSearch"
                      />

                      <button
                        mat-button
                        mat-icon-button
                        matSuffix
                        (click)="clearSearchField(dpListGlobalAttrSearchControl)"
                        *ngIf="dpListGlobalAttrSearch"
                      >
                        <mat-icon>close</mat-icon>
                      </button>
                    </mat-form-field>
                    <div class="scroll-y dp-scroll-content">
                      <div
                        class="attr-search-list"
                        *ngFor="let attribute of dpListAttributes | attributeFilter: dpListGlobalAttrSearch!"
                        (click)="selectAttribute(attribute, 'dpList')"
                        [class.selected]="attribute === selectedListAttribute"
                      >
                        {{ attribute.attributeName }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="attr-button-container">
                  <button class="attr-move-button" mat-icon-button (click)="addAttribute('dpList')">
                    <mat-icon>keyboard_arrow_right</mat-icon>
                  </button>

                  <button class="attr-move-button" mat-icon-button (click)="removeAttribute('dpList')">
                    <mat-icon>keyboard_arrow_left</mat-icon>
                  </button>
                </div>
                <div>
                  <span jhiTranslate="contractmanager.configuration.selectedAttributes">Selected Attributes</span>
                  <div class="dp-attr-search-wrapper">
                    <mat-form-field class="search-attribute">
                      <input
                        type="text"
                        placeholder="Search"
                        aria-label="Number"
                        matInput
                        [formControl]="dpListSelectedAttrSearchControl"
                        [(ngModel)]="dpListSelectedAttrSearch"
                      />

                      <button
                        mat-button
                        mat-icon-button
                        matSuffix
                        (click)="clearSearchField(dpListSelectedAttrSearchControl)"
                        *ngIf="dpListSelectedAttrSearch"
                      >
                        <mat-icon>close</mat-icon>
                      </button>
                    </mat-form-field>
                    <div class="scroll-y dp-scroll-content">
                      <div
                        class="attr-search-list"
                        *ngFor="let attribute of selectedListAttributes! | attributeFilter: dpListSelectedAttrSearch!"
                        (click)="selectAttribute(attribute, 'dpList')"
                        [class.selected]="attribute === selectedListAttribute"
                      >
                        {{ attribute.attributeName }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="displayMode == 'CREATE'; else buttons">
              <div class="d-flex justify-content-between mt-4">
                <button mat-button matStepperPrevious jhiTranslate="contractmanager.shared.previous">Previous</button>
                <div>
                  <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                  <button mat-raised-button color="primary" [disabled]="true" jhiTranslate="contractmanager.shared.create">Create</button>
                </div>
                <button mat-button matStepperNext jhiTranslate="contractmanager.shared.next">Next</button>
              </div>
            </div>
          </cdk-step>

          <cdk-step [formGroup]="teamForm" [stepControl]="teamForm">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.shared.team">Team</span>
            </ng-template>
            <div class="flex-row-container step-header">
              <span jhiTranslate="contractmanager.shared.team">Team</span>
              <div class="flex-spacer"></div>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
              <div>
                <button
                  mat-raised-button
                  color="primary"
                  (click)="openTeamManagementDialog('')"
                  *ngIf="displayMode != 'VIEW'"
                  jhiTranslate="contractmanager.shared.addMember"
                >
                  Add Member
                </button>
              </div>
            </div>
            <div class="flex-col-container edit-container" *ngIf="displayMode != 'VIEW'; else viewTeam">
              <jhi-view-team [assignedUsers]="assignedUsers" (deleteMember)="deleteMember($event)"></jhi-view-team>
            </div>
            <ng-template #teamDialog>
              <jhi-team-management
                [teamForm]="teamForm"
                [teamGroupForm]="teamGroupForm"
                [fields]="teamFields"
                [notificationConfigForm]="notificationConfigForm"
                [notificationConfig]="notificationConfig"
              ></jhi-team-management>
            </ng-template>
            <div class="flex-spacer"></div>
            <div *ngIf="displayMode == 'CREATE'; else buttons">
              <div class="d-flex justify-content-between mt-4">
                <button mat-button matStepperPrevious jhiTranslate="contractmanager.shared.previous">Previous</button>
                <div>
                  <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                  <button mat-raised-button color="primary" [disabled]="true" jhiTranslate="contractmanager.shared.create">Create</button>
                </div>
                <button mat-button matStepperNext [disabled]="teamForm.invalid" jhiTranslate="contractmanager.shared.next">Next</button>
              </div>
            </div>
          </cdk-step>

          <cdk-step [formGroup]="contractTypeForm" [stepControl]="contractTypeForm" *ngIf="displayMode == 'CREATE'">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.shared.verify">Verify</span>
            </ng-template>
            <div>
              <div class="step-header">
                <span jhiTranslate="contractmanager.shared.verify">Verify</span>
              </div>
              <ng-container *ngTemplateOutlet="viewDetails"></ng-container>
              <ng-container *ngTemplateOutlet="viewAttributes"></ng-container>
              <ng-container *ngTemplateOutlet="viewAssociations"></ng-container>
              <ng-container *ngTemplateOutlet="viewDisplayPreferences"></ng-container>
              <ng-container *ngTemplateOutlet="viewTeam"></ng-container>
            </div>
            <div class="d-flex justify-content-between my-4">
              <button mat-button matStepperPrevious jhiTranslate="contractmanager.shared.previous">Previous</button>
              <div>
                <button mat-button color="primary" (click)="cancel('create')">Cancel</button>
                <button mat-raised-button color="primary" (click)="save()" jhiTranslate="contractmanager.shared.create">Create</button>
              </div>
              <div></div>
            </div>
          </cdk-step>

          <cdk-step *ngIf="displayMode == 'VIEW'">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.shared.versions">Versions</span>
            </ng-template>
            <div class="flex-row-container step-header">
              <span jhiTranslate="contractmanager.shared.versions">Versions</span>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
            </div>
            <div class="version-scroll">
              <ng-container *ngIf="contractTypeVersions; else noRevContainer">
                <div
                  class="version-container mb-2 mr-2 d-flex justify-content-between align-items-center"
                  *ngFor="let version of contractTypeVersions"
                >
                  <div>
                    <img src="/content/images/ct-version.svg" alt="version-icon" class="m-1" />
                    <span>Version {{ version.version }}</span>
                  </div>
                  <div>
                    <button mat-button (click)="rollBack(version)">
                      <img src="/content/images/ct-callback.svg" alt="callback-icon" class="m-1" /><span
                        jhiTranslate="contractmanager.shared.rollBack"
                        >Roll Back</span
                      >
                    </button>
                  </div>
                </div>
              </ng-container>
              <ng-template #noRevContainer>
                <div class="summary-block">
                  <p class="text-center" jhiTranslate="contractmanager.configuration.noRevisionsContractType">
                    Revisions are not available for this Contract Type
                  </p>
                </div>
              </ng-template>
            </div>
            <ng-container *ngTemplateOutlet="buttons"></ng-container>
          </cdk-step>

          <cdk-step *ngIf="displayMode == 'VIEW'">
            <ng-template cdkStepLabel>
              <span jhiTranslate="contractmanager.shared.history">History</span>
            </ng-template>

            <div class="flex-row-container step-header">
              <span jhiTranslate="contractmanager.shared.history">History</span>
              <div>
                <ng-container *ngTemplateOutlet="edit"></ng-container>
              </div>
            </div>
            <div class="flex-col-container edit-container history-container">
              <mat-table [dataSource]="contractType!.history">
                <ng-container matColumnDef="events">
                  <mat-header-cell *matHeaderCellDef jhiTranslate="contractmanager.shared.events"> Events </mat-header-cell>
                  <mat-cell *matCellDef="let element"> {{ element.eventMessage }} </mat-cell>
                </ng-container>

                <ng-container matColumnDef="createdBy" jhiTranslate="contractmanager.shared.createdBy">
                  <mat-header-cell *matHeaderCellDef> Created By </mat-header-cell>
                  <mat-cell *matCellDef="let element"> {{ element.createdBy | titlecase }} </mat-cell>
                </ng-container>

                <ng-container matColumnDef="createdOn">
                  <mat-header-cell *matHeaderCellDef jhiTranslate="contractmanager.shared.createdOn"> Created On </mat-header-cell>
                  <mat-cell *matCellDef="let element"> {{ element.createdOn }} </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="historyColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: historyColumns"></mat-row>
              </mat-table>
            </div>
            <ng-container *ngTemplateOutlet="buttons"></ng-container>
          </cdk-step>
        </jhi-cm-stepper>
        <ng-template #viewDetails>
          <div class="flex-grow-1">
            <div class="summary-block">
              <div class="step-header">
                <span jhiTranslate="contractmanager.shared.details">Details</span>
                <div *ngIf="displayMode == 'VIEW'">
                  <span style="font-size: 16px">Status: </span>
                  <div class="status-flag f-14" [ngClass]="getContractTypeFlag()">
                    {{ contractType!.status }}
                  </div>
                </div>
              </div>
              <div *ngIf="displayMode == 'VIEW'">
                <div class="flex-row-wrap section">
                  <div class="form-pair">
                    <div class="form-header" jhiTranslate="contractmanager.shared.version">Version</div>
                    <div class="form-value">{{ contractTypeForm.value.version }}</div>
                  </div>
                  <div class="form-pair">
                    <div class="form-header" jhiTranslate="contractmanager.shared.createdBy">Created By</div>
                    <div class="form-value">{{ contractTypeForm.value.createdBy | titlecase }}</div>
                  </div>
                  <div class="form-pair">
                    <div class="form-header" jhiTranslate="contractmanager.shared.createdOn">Created On</div>
                    <div class="form-value">{{ contractTypeForm.value.createdOn | date: 'MMM d, y, h:mm a' }}</div>
                  </div>
                </div>
              </div>
              <div class="flex-row-wrap section">
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.contactTypeName">Contact Type Name</div>
                  <div class="form-value">{{ contractTypeForm.value.contractTypeName }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.contractTypeCode">Contract Type Code</div>
                  <div class="form-value">{{ contractTypeForm.value.contractTypeCode }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.contractType">Contract Type</div>
                  <div class="form-value">{{ contractTypeForm.value.contractType }}</div>
                </div>
              </div>
              <div>
                <div>
                  <div class="form-header" jhiTranslate="contractmanager.shared.description">Description</div>
                  <div class="form-value wrap-space">{{ contractTypeForm.value.description || '-' }}</div>
                </div>
              </div>
              <div class="flex-row-wrap section">
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.thirdPartyPaper">Third Party Paper</div>
                  <div class="form-value">{{ contractTypeForm.value.allowThirdPartyPaper ? 'Yes' : 'No' }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.clauseAssembly">Clause Assembly</div>
                  <div class="form-value">{{ contractTypeForm.value.allowClauseAssembly ? 'Yes' : 'No' }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.QrCode">QR Code</div>
                  <div class="form-value">{{ contractTypeForm.value.qrCode ? 'Yes' : 'No' }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.enableCollaboration">Enable Collaboration</div>
                  <div class="form-value">{{ contractTypeForm.value.allowClauseAssembly ? 'Yes' : 'No' }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.enableAutoSupersede">Enable Auto Supersede</div>
                  <div class="form-value">{{ contractTypeForm.value.enableAutoSupersede ? 'Yes' : 'No' }}</div>
                </div>
                <div class="form-pair">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.allowCopyWithAssociations">
                    Allow Copy With Associations
                  </div>
                  <div class="form-value">{{ contractTypeForm.value.allowCopyWithAssociations ? 'Yes' : 'No' }}</div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <ng-template #viewAttributes>
          <div class="flex-grow-1">
            <div class="summary-block">
              <div class="step-header">
                <span jhiTranslate="contractmanager.shared.attributes">Attributes</span>
              </div>
              <div class="form-header" jhiTranslate="contractmanager.configuration.selectedAttributes">Selected Attributes</div>
              <div class="flex-row-wrap section">
                <div class="form-pair" *ngFor="let attribute of selectedAttributes">
                  <div class="form-value">{{ attribute.attributeName }}</div>
                </div>
                <div *ngIf="selectedAttributes.length == 0" jhiTranslate="contractmanager.configuration.noAttributesSelected">
                  No Attributes were Selected
                </div>
                <!--            <div *ngIf="selectedAttributes.length > 0" class="flex-row-wrap section preview-box" >-->
              </div>
              <div *ngIf="selectedAttributes.length > 0" class="flex-row-wrap section preview-box" (click)="downloadAttributes()">
                <div class="preview-btn">
                  <mat-icon>cloud_download</mat-icon>
                  <span class="preview-text" jhiTranslate="contractmanager.shared.download">Download</span>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <ng-template #viewAssociations>
          <div class="flex-grow-1">
            <div class="summary-block">
              <div class="step-header">
                <span jhiTranslate="contractmanager.configuration.associations">Associations</span>
              </div>
              <div>-</div>
            </div>
          </div>
        </ng-template>
        <ng-template #viewDisplayPreferences>
          <div class="flex-grow-1">
            <div class="summary-block">
              <div class="step-header">
                <span jhiTranslate="contractmanager.configuration.displayPreference">Display Preference</span>
              </div>
              <div class="flex-row-wrap section">
                <div>
                  <div class="form-header" jhiTranslate="contractmanager.configuration.attributesForAgreementTileView">
                    Attributes to show on agreement tile view
                  </div>
                  <div class="col-layout">
                    <div class="form-pair" *ngFor="let attribute of selectedTileAttributes">
                      <div class="form-value">{{ attribute.attributeName }}</div>
                    </div>
                    <div *ngIf="selectedTileAttributes!.length == 0" jhiTranslate="contractmanager.configuration.noAttributesSelected">
                      No Attributes were Selected
                    </div>
                  </div>
                </div>
                <div style="margin-left: 40px">
                  <div class="form-header" jhiTranslate="contractmanager.configuration.attributesForAgreementDetails">
                    Attributes to show on agreement details view
                  </div>
                  <div class="col-layout">
                    <div class="form-pair" *ngFor="let attribute of selectedListAttributes">
                      <div class="form-value">{{ attribute.attributeName }}</div>
                    </div>
                    <div *ngIf="selectedListAttributes!.length == 0" jhiTranslate="contractmanager.configuration.noAttributesSelected">
                      No Attributes were Selected
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <ng-template #viewTeam>
          <div class="flex-grow-1">
            <div class="summary-block">
              <div class="step-header">
                <span jhiTranslate="contractmanager.shared.team">Team</span>
              </div>
              <div class="flex-row-wrap section">
                <div class="form-pair" *ngFor="let user of assignedUsers">
                  <div class="form-value">{{ user.firstName + ' ' + user.lastName | titlecase }}</div>
                  <div class="form-value user-role">{{ user.role }}</div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <ng-template #update>
          <div class="stepper-control">
            <button
              mat-raised-button
              color="primary"
              [disabled]="contractTypeForm.invalid"
              (click)="updateType()"
              jhiTranslate="contractmanager.shared.save"
            >
              Save
            </button>
          </div>
        </ng-template>
        <ng-template #buttons>
          <div *ngIf="displayMode == 'VIEW' && entityRole !== 'OBSERVER'" class="d-flex justify-content-center mt-2">
            <div [ngSwitch]="contractType!.status">
              <div *ngSwitchCase="'DRAFT'">
                <button
                  mat-raised-button
                  color="primary"
                  (click)="openRequestApprovalDialog()"
                  jhiTranslate="contractmanager.shared.sendForApproval"
                  *ngIf="entityRole == 'PRIMARY_OWNER'"
                >
                  Send for Approval
                </button>

                <button mat-button color="primary" *ngIf="entityRole == 'PRIMARY_OWNER'" (click)="deleteContractType()">Delete</button>
              </div>
              <div *ngSwitchCase="'APPROVAL_REJECTED'">
                <button
                  mat-raised-button
                  color="primary"
                  (click)="openRequestApprovalDialog()"
                  jhiTranslate="contractmanager.shared.sendForApproval"
                  *ngIf="entityRole == 'PRIMARY_OWNER'"
                >
                  Send for Approval
                </button>

                <button mat-button color="primary" *ngIf="entityRole == 'PRIMARY_OWNER'" (click)="deleteContractType()">Delete</button>
              </div>
              <div *ngSwitchCase="'APPROVED'">
                <!-- <button mat-raised-button color="primary" *ngIf="entityRole == 'PRIMARY_OWNER'">Return to Requestor</button> -->

                <button mat-button color="primary" *ngIf="entityRole == 'PRIMARY_OWNER'" (click)="deleteContractType()">Delete</button>
              </div>
              <div *ngSwitchCase="'CANCELLED'">
                <button mat-raised-button color="primary">Revert Cancellation</button>

                <button mat-raised-button color="primary" *ngIf="entityRole == 'PRIMARY_OWNER'" (click)="deleteContractType()">
                  Delete
                </button>
              </div>
              <div *ngSwitchCase="'APPROVAL_PENDING'">
                <button mat-raised-button color="primary" *ngIf="entityRole == 'APPROVER'" (click)="rejectEntity()">Reject</button>

                <button
                  mat-raised-button
                  color="primary"
                  (click)="openApproveDialog()"
                  *ngIf="entityRole == 'APPROVER'"
                  jhiTranslate="contractmanager.shared.approve"
                >
                  Approve
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="displayMode == 'UPDATE'" class="d-flex justify-content-center mt-4">
            <div>
              <button mat-button color="primary" (click)="cancel('update')">Cancel</button>

              <button
                mat-raised-button
                color="primary"
                [disabled]="contractTypeForm.invalid"
                (click)="updateType()"
                jhiTranslate="contractmanager.shared.save"
              >
                Save
              </button>
            </div>
          </div>
        </ng-template>
        <ng-template #edit>
          <div *ngIf="displayMode == 'VIEW'">
            <button
              mat-raised-button
              color="primary"
              (click)="displayMode = 'UPDATE'"
              jhiTranslate="contractmanager.shared.edit"
              *ngIf="entityRole == 'PRIMARY_OWNER'"
            >
              Edit
            </button>
          </div>
        </ng-template>
      </form>
    </div>
  </div>

  <ng-template #pageLoadingSpinner>
    <div class="load-spinner-wrapper">
      <div class="load-spinner-container">
        <mat-spinner></mat-spinner>
      </div>
    </div>
  </ng-template>
</div>
